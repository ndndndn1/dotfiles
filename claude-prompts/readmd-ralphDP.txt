================================================================
  Ralph Loop - 파일 관계 및 경로 구조
================================================================

0. Quick start
# 터미널 1 - Planner
claude -p "/ralph-loop $(cat ~/claude-prompts/planner-prompt.txt | sed "s|{{PROJECT_DESCRIPTION}}|논문 검색과 human-loop를 통한 agent friendly 인터랙티브 연구노트 개발|") --max-iterations 30 --completion-promise PLANNING_COMPLETE"
/ralph-loop "OBJECTIVE: '논문 검색과 human-loop를 통한 agent friendly 인터랙티브 연구노트 개발' \n\n $(cat ~/claude-prompts/planner-prompt.txt)" --max-iterations 30 --completion-promise "PLANNING_COMPLETE"

# 터미널 2 - Worker (Planner가 queue/ 채운 후)
claude -p "/ralph-loop $(cat ~/claude-prompts/worker-prompt.txt) --max-iterations 50 --completion-promise WORK_COMPLETE"
/ralph-loop "OBJECTIVE: '계획에 따라 순차적 구현 수행' \n\n $(cat ~/claude-prompts/worker-prompt.txt)" --max-iterations 50 --completion-promise "WORK_COMPLETE"


1. DOTFILES REPO (GitHub → Codespace 자동 클론)
================================================================

  GitHub: your-dotfiles repo
       │
       ▼  (Codespace 생성 시 자동 클론)
  /workspaces/.codespaces/.persistedshare/dotfiles/
       │
       ├── install.sh ◀── Codespace가 자동 실행
       │     │
       │     ├── curl gist → Claude Code CLI 설치
       │     ├── claude plugin install ralph-wiggum
       │     └── ln -sf → ~/claude-prompts/ 심링크 생성
       │
       └── claude-prompts/          ◀── 원본 프롬프트 파일
             ├── planner-prompt.txt
             └── worker-prompt.txt


2. 심링크 연결
================================================================

  원본 (dotfiles repo)                    심링크 (홈 디렉토리)
  ─────────────────────                   ─────────────────────
  .../dotfiles/claude-prompts/            ~/claude-prompts/
       │                                       │
       ├── planner-prompt.txt  ←── ln -sf ──  planner-prompt.txt
       └── worker-prompt.txt   ←── ln -sf ──  worker-prompt.txt

  * 사용 시 항상 ~/claude-prompts/ 경로로 접근
  * dotfiles에서 git pull 하면 심링크를 통해 자동 반영


3. 프로젝트 런타임 구조 (.tasks/)
================================================================

  /workspaces/your-project/            ◀── 실제 작업 프로젝트
       │
       ├── .tasks/                     ◀── Planner가 생성, Worker가 소비
       │     ├── DAG.md                     전체 의존성 그래프
       │     ├── pending/                   의존성 미충족 task
       │     ├── queue/                     구현 가능 task (Worker 대기)
       │     ├── in-progress/               Worker 작업 중
       │     ├── done/                      완료된 task
       │     └── failed/                    실패한 task
       │
       ├── notes.txt                   ◀── Worker↔Planner 피드백 채널
       │
       ├── src/                             구현 코드
       └── tests/                           테스트 코드


4. 실행 흐름
================================================================

  터미널 1 (Planner)                    터미널 2 (Worker)
  ──────────────────                    ──────────────────

  /ralph-loop "..." \                   /ralph-loop "..." \
    --max-iterations 30 \                 --max-iterations 50 \
    --completion-promise                  --completion-promise
    "PLANNING_COMPLETE"                   "WORK_COMPLETE"
       │                                       │
       ▼                                       ▼
  ┌─────────────┐                        ┌─────────────┐
  │ DP 분해     │                        │ queue/ 확인  │
  │ DAG.md 생성 │                        │             │
  │ queue/ 배치 │──── .tasks/ ──────────▶│ task 선택   │
  └──────┬──────┘    파일시스템           │ TDD 구현    │
         │           통신                 │ 테스트 실행  │
         ▼                               └──────┬──────┘
  ┌─────────────┐                               │
  │ promote     │◀── done/ 감지 ────────────────┘
  │ pending →   │
  │   queue     │──── queue/ 추가 ─────▶ 다음 task 처리
  └──────┬──────┘
         │
         ▼
  ┌─────────────┐                        ┌─────────────┐
  │ 모든 task   │                        │ 모든 task   │
  │ done/?      │                        │ done/?      │
  └──────┬──────┘                        └──────┬──────┘
         │ YES                                  │ YES
         ▼                                      ▼
  <promise>                              <promise>
  PLANNING_COMPLETE                      WORK_COMPLETE
  </promise>                             </promise>
         │                                      │
         ▼                                      ▼
    ralph-loop 종료                        ralph-loop 종료


5. 파일별 역할 요약
================================================================

  파일                        누가 쓰나    역할
  ─────────────────────────   ──────────   ─────────────────────
  install.sh                  Codespace    CLI + 플러그인 + 심링크 설치
  planner-prompt.txt          사용자→CLI   Planner 에이전트 규칙
  worker-prompt.txt           사용자→CLI   Worker 에이전트 규칙
  .tasks/DAG.md               Planner      의존성 그래프 + 진행률
  .tasks/pending/*.md         Planner      의존성 미충족 task 스펙
  .tasks/queue/*.md           Planner      Worker가 가져갈 task 스펙
  .tasks/in-progress/*.md     Worker       작업 중 task
  .tasks/done/*.md            Worker       완료 task + 결과 기록
  .tasks/failed/*.md          Worker       실패 task + 원인 기록
  notes.txt                   Worker       Planner에게 전달할 피드백
